<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <title>Gioco del Pollo</title>
    <link rel="stylesheet" href="TemplateData/style.css">
    <link rel="manifest" href="manifest.webmanifest">
</head>
<body>
    <div id="unity-container">
        <canvas id="unity-canvas" width="1080" height="1920" tabindex="-1"></canvas>
        <div id="unity-loading-bar">
            <div id="unity-logo"></div>
            <div id="unity-progress-bar-empty">
                <div id="unity-progress-bar-full"></div>
            </div>
        </div>
        <div id="unity-warning"></div>
    </div>

    <div id="orientation-warning" style="display:none; text-align:center; font-size:24px; padding:50px;">
        Пожалуйста, поверните устройство вертикально
    </div>

    <script src="Build/builds.loader.js"></script>
    <script>
        var canvas = document.getElementById('unity-canvas');
        var loadingBar = document.getElementById('unity-loading-bar');
        var warningBanner = document.getElementById('unity-warning');

        var config = {
            dataUrl: "Build/builds.data",
            frameworkUrl: "Build/builds.framework.js",
            codeUrl: "Build/builds.wasm",
            streamingAssetsUrl: "StreamingAssets",
            companyName: "DefaultCompany",
            productName: "Gioco del Pollo",
            productVersion: "1.0",
            showBanner: function(msg, type){ console.log(msg); }
        };

        createUnityInstance(canvas, config, function(progress) {
            document.getElementById("unity-progress-bar-full").style.width = (100 * progress) + "%";
        }).then(function(unityInstance){
            loadingBar.style.display = "none";
        }).catch(alert);

        // -------------------
        // Проверка ориентации для Telegram WebView
        function isMobile() {
            return /Mobi|Android|iPhone|iPad/i.test(navigator.userAgent);
        }

        function isTelegramWebView() {
            return /Telegram/i.test(navigator.userAgent);
        }

        function checkOrientation() {
            if(isMobile() && window.innerHeight < window.innerWidth) {
                // Горизонтальная ориентация на мобилке
                canvas.style.display = 'none';
                loadingBar.style.display = 'none';
                warningBanner.style.display = 'none';
                document.getElementById('orientation-warning').style.display = 'block';
            } else {
                // Портретная ориентация или ПК
                canvas.style.display = 'block';
                loadingBar.style.display = 'block';
                warningBanner.style.display = 'block';
                document.getElementById('orientation-warning').style.display = 'none';
            }
        }

        window.addEventListener('resize', checkOrientation);
        window.addEventListener('load', checkOrientation);
    </script>
</body>
</html>
